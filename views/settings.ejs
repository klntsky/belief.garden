<!-- views/settings.ejs -->
<div class="content">
  <h1>Settings</h1>
  
  <div class="settings-container">
    <form id="settings-form">
      <div class="setting-item">
        <label>
          <input type="checkbox" id="allowAllDebates" name="allowAllDebates" <%= settings.allowAllDebates ? 'checked' : '' %>>
          Allow replies from other users for all my belief card comments.
        </label>
        <p class="setting-description">
          When enabled, debates can be started on any card, if there is an existing comment.

          Note: This only applies to non-banned users.
        </p>
      </div>
      
      <button type="submit" class="btn">Save Settings</button>
    </form>
  </div>
</div>

<script>
document.getElementById('settings-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const settings = {
    allowAllDebates: document.getElementById('allowAllDebates').checked
  };
  
  try {
    const response = await fetch('/api/settings', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(settings)
    });
    
    if (response.ok) {
      Toastify({
        text: "Settings saved successfully!",
        duration: 3000,
        gravity: "top",
        position: "right",
        style: { background: "#4CAF50" }
      }).showToast();
    } else {
      throw new Error('Failed to save settings');
    }
  } catch (error) {
    Toastify({
      text: "Error saving settings: " + error.message,
      duration: 3000,
      gravity: "top",
      position: "right",
      style: { background: "#F44336" }
    }).showToast();
  }
});
</script>

<style>
.settings-container {
  max-width: 600px;
  margin: 20px auto;
  padding: 20px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
}

.setting-item {
  margin-bottom: 20px;
}

.setting-item label {
  display: flex;
  align-items: center;
  font-size: 1.1em;
  margin-bottom: 5px;
}

.setting-description {
  font-size: 0.9em;
  margin-left: 25px;
}

.btn {
  background: #A55;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 1em;
}

.btn:hover {
  background: #944;
}
</style>
